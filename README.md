# 智果分拣大师 - 基于RT-Thread与双镜面视觉的智能农产品分拣系统 🍎🤖

[![OS](https://img.shields.io/badge/OS-RT--Thread-brightgreen.svg)](https://www.rt-thread.org)
[![Model](https://img.shields.io/badge/AI%20Model-MobileNetV3-blue.svg)](#)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Competition](https://img.shields.io/badge/嵌入式大赛-参赛作品-orange.svg)](#)

> 一款搭载 **RT-Thread** 实时操作系统，并独创性地采用 **“双镜面全景视觉”** 技术，实现对苹果等农产品进行 **360°无死角** 瑕疵检测与自动化分拣的智能装置。

---

## 🌟 项目亮点 (Highlights)

*   **⚡ 实时高效**：基于国产优秀实时操作系统 **RT-Thread**，确保了机械控制（传送带、推杆）与视觉分析任务的微秒级响应与精准协同。
*   **🧠 轻量智能**：在嵌入式端部署轻量级卷积神经网络 **MobileNetV3**，在有限的算力下实现了高精度的图像分类，完美平衡了性能与功耗。
*   **👁️ 全景视觉 (核心创新)**：**独创“单摄+双镜面”方案**，利用物理反射与图像算法，以极低的硬件成本实现了对检测目标 **360° 全方位的表面瑕疵覆盖**，解决了传统单摄像头视觉检测存在的“背面盲区”问题。
*   **🦾 软硬一体**：从硬件选型、电路搭建到操作系统移植、驱动编写、AI模型集成与应用逻辑开发，实现了全栈自研，展现了团队强大的工程实践能力。
*   **🧩 模块化设计**：系统结构清晰，易于扩展，未来可快速适配至柑橘、土豆、番茄等其他形态的农产品检测，具有广阔的应用前景。

## 🎬 系统演示 (Demo)

*在这里放置一张您设备运行的GIF动图或视频截图，它比任何文字都更有说服力！*

![项目演示GIF](【请替换为您项目演示的GIF或图片链接】)

## 🏗️ 系统架构 (System Architecture)

本系统分为硬件层、系统层和应用层，三者紧密耦合，协同工作。

### 流程图

我们使用Mermaid语法绘制了系统的工作流程图，直观展示了从苹果上料到分拣完成的全过程。

```mermaid
graph TD
    A[开始: 放置苹果于传送带] --> B{传送带启动};
    B --> C[苹果进入检测区域];
    C --> D[📸 摄像头捕捉图像<br>(包含苹果正面与镜面反射)];
    D --> E[🧠 图像预处理<br>1. 识别并校正镜面图像<br>2. 裁剪出正面与背面两个ROI];
    E --> F[🤖 AI模型推理<br>MobileNetV3分别预测两个ROI];
    F --> G{决策融合<br>任一图像为'坏果'即判定为'坏果'};
    G -- 好苹果 --> H[✅ 推杆无动作];
    G -- 坏苹果 --> I[❌ 控制推杆伸出];
    I --> J[⚡ 推杆将坏果推离传送带];
    J --> K[🔄 推杆自动缩回];
    H --> L[苹果继续传送至收集区];
    K --> L;
    L --> M[等待下一个苹果];
    M --> C;
```

## 💡 核心创新：双镜面视觉技术详解

传统工业分拣通常需要多个摄像头或复杂的机械翻转结构才能实现全方位检测，成本高、结构复杂。我们通过一个巧妙的设计解决了这个问题。

1.  **问题定义**：单个摄像头只能看到苹果的一面，背面的虫眼、腐烂或疤痕会被遗漏。
2.  **我们的方案**：在传送带侧面以特定角度放置一面或两面镜子。当苹果经过时，摄像头可以**同时**捕捉到苹果的正面视图和通过镜子反射的侧面/背面视图。
3.  **算法实现**：
    *   **透视变换 (Perspective Transform)**：由于镜面成像是倾斜的，我们首先通过定位镜子在图像中的四个顶点，然后应用透视变换算法，将倾斜的镜面图像“拉伸”成一个与正面视图平行的、无畸变的矩形图像。
    *   **ROI提取 (Region of Interest)**：从原始图像中精确裁剪出“苹果正面”和经过校正的“苹果背面”两个独立的图像区域。
    *   **双路推理与决策**：将这两个ROI图像**同时或依次**输入到MobileNetV3模型中进行推理。最终的决策逻辑是：`if (正面 == "坏果" || 背面 == "坏果") then 最终结果 = "坏果" else 最终结果 = "好果"`。

这个方案不仅极大地降低了硬件成本，还展现了我们在图像处理算法与工程应用结合方面的创新能力。

![镜面视觉原理图](【建议您画一个简单的原理图放在这里，展示相机、苹果、镜子的位置关系】)

## 硬件清单 (Hardware Components)

| 组件名称              | 型号/规格         | 用途                               |
| --------------------- | ----------------- | ---------------------------------- |
| **主控开发板**        | 【您的开发板型号】    | 运行RT-Thread，处理所有逻辑        |
| **摄像头模组**        | 【您的摄像头型号】    | 图像采集                           |
| **H桥电机驱动模块**   | L298N 或类似模块  | 驱动传送带直流电机                 |
| **传送带及电机**      | 【您的传送带规格】    | 运输检测对象                       |
| **推杆执行器**        | 直流电动推杆      | 将坏果推出传送带                   |
| **镜子**              | 普通平面镜        | 反射苹果背面图像，实现全景视觉     |
| **结构件与线材**      | 杜邦线, 3D打印件等 | 构建整个机械结构并连接电路         |

## 软件环境 (Software Stack)

*   **操作系统**: RT-Thread 【您的版本号, e.g., v4.0.5】
*   **开发环境**: RT-Thread Studio
*   **编程语言**: C / C++
*   **核心库**:
    *   RT-Thread Kernel & Device Drivers
    *   【如果用了AI推理库，请写上，如ART-Pi SDK, NNoM等】
    *   【如果用了图像处理库，请写上，如OpenMV API等】

## 🚀 如何开始 (Getting Started)

1.  **硬件搭建**: 根据 `【硬件连接图/说明文档的路径】` 完成所有硬件的连接。
2.  **克隆仓库**:
    ```bash
    git clone https://github.com/【您的用户名】/【您的仓库名】.git
    ```
3.  **打开项目**: 使用 RT-Thread Studio 导入本项目。
4.  **编译与下载**:
    *   连接开发板到电脑。
    *   在 RT-Thread Studio 中点击 "Build"进行编译。
    *   编译成功后，点击 "Download" 将固件烧录到开发板。
5.  **运行**:
    *   断开下载器，重新给设备上电。
    *   系统将自动初始化并开始运行。将一个苹果放置在传送带起始端即可开始体验！

## 📂 项目文件结构

```
.
├── applications         # 主要应用逻辑代码
│   ├── main.c           # 程序入口
│   └── sorter_logic.c   # 分拣核心逻辑
├── drivers              # 开发板驱动文件
├── libraries            # 第三方库与组件
│   └── ai_model         # 存放MobileNetV3模型相关文件
├── rt-thread            # RT-Thread内核源码
├── README.md            # 本说明文档
└── ...                  # 其他RT-Thread Studio项目文件
```

## 展望未来 (Future Work)

*   [ ] **模型优化**: 进一步量化和剪枝模型，提升推理速度，降低功耗。
*   [ ] **多品类支持**: 训练支持更多农产品（如橙子、梨、土豆）的检测模型，并设计可调节的机械结构。
*   [ ] **数据闭环**: 将检测结果（好/坏果数量、瑕疵类型）通过Wi-Fi上传到云端，进行数据统计与分析，为农业生产提供数据支持。
*   [ ] **集成称重**: 增加压力传感器，实现重量分级，提升产品附加值。

## 👨‍💻 团队成员 (Our Team)

*   **【张三】** - 项目负责人，负责整体架构与软件开发。
*   **【李四】** - 硬件工程师，负责电路设计与机械结构。
*   **【王五】** - 算法工程师，负责AI模型训练与图像处理算法。

## 📜 开源许可 (License)

本项目采用 [MIT License](LICENSE) 开源。
